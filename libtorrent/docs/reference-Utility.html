<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.14: http://docutils.sourceforge.net/" />
<title>reference-Utility.rst</title>
<meta name="author" content="Arvid Norberg, arvid&#64;libtorrent.org" />
<meta name=viewport content="width=device-width, initial-scale=1">
<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'https://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script>
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" type="text/css" href="rst.css" />
<style type="text/css">
/* Hides from IE-mac \*/
* html pre { height: 1%; }
/* End hide from IE-mac */
</style>
</head>
<body>
<div class="document">
    <div id="container">
    <a href="index.html"><table id="header">
    <tr><td id="orange"></td>
    <td id="logo">libtorrent</td></tr>
    </table></a>
    <div id="main">

<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Arvid Norberg, <a class="last reference external" href="mailto:arvid&#64;libtorrent.org">arvid&#64;libtorrent.org</a></td></tr>
<tr><th class="docinfo-name">Version:</th>
<td>1.2.0</td></tr>
</tbody>
</table>
<p><a class="reference external" href="reference.html">home</a></p>
<div class="section" id="utility">
<h1>Utility</h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#utility" id="id40">Utility</a><ul>
<li><a class="reference internal" href="#bitfield" id="id41">bitfield</a></li>
<li><a class="reference internal" href="#hasher512" id="id42">hasher512</a></li>
<li><a class="reference internal" href="#hasher" id="id43">hasher</a></li>
<li><a class="reference internal" href="#id36" id="id44">operator&lt;&lt;()</a></li>
<li><a class="reference internal" href="#id38" id="id45">operator&gt;&gt;()</a></li>
</ul>
</li>
</ul>
</div>
<a name="bitfield"></a><div class="section" id="bitfield">
<h2>bitfield</h2>
<p>Declared in &quot;<a class="reference external" href="../include/libtorrent/bitfield.hpp">libtorrent/bitfield.hpp</a>&quot;</p>
<p>The <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> type stores any number of bits as a <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a>
in a heap allocated array.</p>
<pre class="literal-block">
struct bitfield
{
   <strong>bitfield</strong> (int bits, bool val);
   <strong>bitfield</strong> () noexcept = default;
   <strong>bitfield</strong> (bitfield const&amp; rhs);
   explicit <strong>bitfield</strong> (int bits);
   <strong>bitfield</strong> (bitfield&amp;&amp; rhs) noexcept = default;
   <strong>bitfield</strong> (char const* b, int bits);
   void <strong>assign</strong> (char const* b, int const bits);
   bool <strong>operator[]</strong> (int index) const noexcept;
   bool <strong>get_bit</strong> (int index) const noexcept;
   void <strong>clear_bit</strong> (int index) noexcept;
   void <strong>set_bit</strong> (int index) noexcept;
   bool <strong>all_set</strong> () const noexcept;
   bool <strong>none_set</strong> () const noexcept;
   int <strong>size</strong> () const noexcept;
   int <strong>num_words</strong> () const noexcept;
   bool <strong>empty</strong> () const noexcept;
   char* <strong>data</strong> () noexcept;
   char const* <strong>data</strong> () const noexcept;
   bitfield&amp; <strong>operator=</strong> (bitfield const&amp; rhs);
   bitfield&amp; <strong>operator=</strong> (bitfield&amp;&amp; rhs) noexcept = default;
   void <strong>swap</strong> (bitfield&amp; rhs) noexcept;
   int <strong>count</strong> () const noexcept;
   int <strong>find_last_clear</strong> () const noexcept;
   int <strong>find_first_set</strong> () const noexcept;
};
</pre>
<a name="bitfield()"></a><div class="section" id="id5">
<h3>bitfield()</h3>
<pre class="literal-block">
<strong>bitfield</strong> (int bits, bool val);
<strong>bitfield</strong> () noexcept = default;
<strong>bitfield</strong> (bitfield const&amp; rhs);
explicit <strong>bitfield</strong> (int bits);
<strong>bitfield</strong> (bitfield&amp;&amp; rhs) noexcept = default;
<strong>bitfield</strong> (char const* b, int bits);
</pre>
<p>constructs a new <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a>. The default constructor creates an empty
<a class="reference external" href="reference-Utility.html#bitfield">bitfield</a>. <tt class="docutils literal">bits</tt> is the size of the <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> (specified in bits).
<tt class="docutils literal">val</tt> is the value to initialize the bits to. If not specified
all bits are initialized to 0.</p>
<p>The constructor taking a pointer <tt class="docutils literal">b</tt> and <tt class="docutils literal">bits</tt> copies a <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a>
from the specified buffer, and <tt class="docutils literal">bits</tt> number of bits (rounded up to
the nearest byte boundary).</p>
<a name="assign()"></a></div>
<div class="section" id="assign">
<h3>assign()</h3>
<pre class="literal-block">
void <strong>assign</strong> (char const* b, int const bits);
</pre>
<p>copy <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> from buffer <tt class="docutils literal">b</tt> of <tt class="docutils literal">bits</tt> number of bits, rounded up to
the nearest byte boundary.</p>
<a name="operator[]()"></a></div>
<div class="section" id="operator">
<h3>operator[]()</h3>
<pre class="literal-block">
bool <strong>operator[]</strong> (int index) const noexcept;
</pre>
<p>query bit at <tt class="docutils literal">index</tt>. Returns true if bit is 1, otherwise false.</p>
<a name="set_bit()"></a>
<a name="clear_bit()"></a></div>
<div class="section" id="set-bit-clear-bit">
<h3>set_bit() clear_bit()</h3>
<pre class="literal-block">
void <strong>clear_bit</strong> (int index) noexcept;
void <strong>set_bit</strong> (int index) noexcept;
</pre>
<p>set bit at <tt class="docutils literal">index</tt> to 0 (clear_bit) or 1 (set_bit).</p>
<a name="all_set()"></a></div>
<div class="section" id="all-set">
<h3>all_set()</h3>
<pre class="literal-block">
bool <strong>all_set</strong> () const noexcept;
</pre>
<p>returns true if all bits in the <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> are set</p>
<a name="size()"></a></div>
<div class="section" id="size">
<h3>size()</h3>
<pre class="literal-block">
int <strong>size</strong> () const noexcept;
</pre>
<p>returns the size of the <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> in bits.</p>
<a name="empty()"></a></div>
<div class="section" id="empty">
<h3>empty()</h3>
<pre class="literal-block">
bool <strong>empty</strong> () const noexcept;
</pre>
<p>returns true if the <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> has zero size.</p>
<a name="data()"></a></div>
<div class="section" id="data">
<h3>data()</h3>
<pre class="literal-block">
char* <strong>data</strong> () noexcept;
char const* <strong>data</strong> () const noexcept;
</pre>
<p>returns a pointer to the internal buffer of the <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a>.</p>
<a name="operator=()"></a></div>
<div class="section" id="id15">
<h3>operator=()</h3>
<pre class="literal-block">
bitfield&amp; <strong>operator=</strong> (bitfield const&amp; rhs);
</pre>
<p>assignment operator</p>
<a name="find_last_clear()"></a>
<a name="count()"></a>
<a name="find_first_set()"></a></div>
<div class="section" id="find-last-clear-count-find-first-set">
<h3>find_last_clear() count() find_first_set()</h3>
<pre class="literal-block">
int <strong>count</strong> () const noexcept;
int <strong>find_last_clear</strong> () const noexcept;
int <strong>find_first_set</strong> () const noexcept;
</pre>
<p>count the number of bits in the <a class="reference external" href="reference-Utility.html#bitfield">bitfield</a> that are set to 1.</p>
<a name="hasher512"></a></div>
</div>
<div class="section" id="hasher512">
<h2>hasher512</h2>
<p>Declared in &quot;<a class="reference external" href="../include/libtorrent/hasher512.hpp">libtorrent/hasher512.hpp</a>&quot;</p>
<p>this is a SHA-512 hash class.</p>
<p>You use it by first instantiating it, then call <tt class="docutils literal">update()</tt> to feed it
with data. i.e. you don't have to keep the entire buffer of which you want to
create the hash in memory. You can feed the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> parts of it at a time. When
You have fed the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> with all the data, you call <tt class="docutils literal">final()</tt> and it
will return the sha1-hash of the data.</p>
<p>The constructor that takes a <tt class="docutils literal">char const*</tt> and an integer will construct the
sha1 context and feed it the data passed in.</p>
<p>If you want to reuse the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> object once you have created a hash, you have to
call <tt class="docutils literal">reset()</tt> to reinitialize it.</p>
<p>The built-in software version of the sha512-algorithm is from LibTomCrypt
For more info, see <tt class="docutils literal">src/sha512.cpp</tt>.</p>
<pre class="literal-block">
class hasher512
{
   <strong>hasher512</strong> ();
   <strong>hasher512</strong> (hasher512 const&amp;);
   explicit <strong>hasher512</strong> (span&lt;char const&gt; data);
   hasher512&amp; <strong>operator=</strong> (hasher512 const&amp;) &amp;;
   hasher512&amp; <strong>update</strong> (span&lt;char const&gt; data);
   sha512_hash <strong>final</strong> ();
   void <strong>reset</strong> ();
   <strong>~hasher512</strong> ();
};
</pre>
<a name="hasher512()"></a>
<a name="operator=()"></a><div class="section" id="hasher512-operator">
<h3>hasher512() operator=()</h3>
<pre class="literal-block">
<strong>hasher512</strong> (hasher512 const&amp;);
explicit <strong>hasher512</strong> (span&lt;char const&gt; data);
hasher512&amp; <strong>operator=</strong> (hasher512 const&amp;) &amp;;
</pre>
<p>this is the same as default constructing followed by a call to
<tt class="docutils literal">update(data)</tt>.</p>
<a name="update()"></a></div>
<div class="section" id="update">
<h3>update()</h3>
<pre class="literal-block">
hasher512&amp; <strong>update</strong> (span&lt;char const&gt; data);
</pre>
<p>append the following bytes to what is being hashed</p>
<a name="final()"></a></div>
<div class="section" id="final">
<h3>final()</h3>
<pre class="literal-block">
sha512_hash <strong>final</strong> ();
</pre>
<p>store the SHA-512 digest of the buffers previously passed to
<a class="reference external" href="reference-Utility.html#update()">update()</a> and the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> constructor.</p>
<a name="reset()"></a></div>
<div class="section" id="reset">
<h3>reset()</h3>
<pre class="literal-block">
void <strong>reset</strong> ();
</pre>
<p>restore the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> state to be as if the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> has just been
default constructed.</p>
<a name="hasher"></a></div>
</div>
<div class="section" id="hasher">
<h2>hasher</h2>
<p>Declared in &quot;<a class="reference external" href="../include/libtorrent/hasher.hpp">libtorrent/hasher.hpp</a>&quot;</p>
<p>this is a SHA-1 hash class.</p>
<p>You use it by first instantiating it, then call <tt class="docutils literal">update()</tt> to feed it
with data. i.e. you don't have to keep the entire buffer of which you want to
create the hash in memory. You can feed the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> parts of it at a time. When
You have fed the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> with all the data, you call <tt class="docutils literal">final()</tt> and it
will return the sha1-hash of the data.</p>
<p>The constructor that takes a <tt class="docutils literal">char const*</tt> and an integer will construct the
sha1 context and feed it the data passed in.</p>
<p>If you want to reuse the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> object once you have created a hash, you have to
call <tt class="docutils literal">reset()</tt> to reinitialize it.</p>
<p>The built-in software version of sha1-algorithm was implemented
by Steve Reid and released as public domain.
For more info, see <tt class="docutils literal">src/sha1.cpp</tt>.</p>
<pre class="literal-block">
class hasher
{
   <strong>hasher</strong> ();
   explicit <strong>hasher</strong> (span&lt;char const&gt; data);
   <strong>hasher</strong> (char const* data, int len);
   <strong>hasher</strong> (hasher const&amp;);
   hasher&amp; <strong>operator=</strong> (hasher const&amp;) &amp;;
   hasher&amp; <strong>update</strong> (span&lt;char const&gt; data);
   hasher&amp; <strong>update</strong> (char const* data, int len);
   sha1_hash <strong>final</strong> ();
   void <strong>reset</strong> ();
   <strong>~hasher</strong> ();
};
</pre>
<a name="hasher()"></a>
<a name="operator=()"></a><div class="section" id="hasher-operator">
<h3>hasher() operator=()</h3>
<pre class="literal-block">
explicit <strong>hasher</strong> (span&lt;char const&gt; data);
<strong>hasher</strong> (char const* data, int len);
<strong>hasher</strong> (hasher const&amp;);
hasher&amp; <strong>operator=</strong> (hasher const&amp;) &amp;;
</pre>
<p>this is the same as default constructing followed by a call to
<tt class="docutils literal">update(data, len)</tt>.</p>
<a name="update()"></a></div>
<div class="section" id="id29">
<h3>update()</h3>
<pre class="literal-block">
hasher&amp; <strong>update</strong> (span&lt;char const&gt; data);
hasher&amp; <strong>update</strong> (char const* data, int len);
</pre>
<p>append the following bytes to what is being hashed</p>
<a name="final()"></a></div>
<div class="section" id="id30">
<h3>final()</h3>
<pre class="literal-block">
sha1_hash <strong>final</strong> ();
</pre>
<p>returns the SHA-1 digest of the buffers previously passed to
<a class="reference external" href="reference-Utility.html#update()">update()</a> and the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> constructor.</p>
<a name="reset()"></a></div>
<div class="section" id="id33">
<h3>reset()</h3>
<pre class="literal-block">
void <strong>reset</strong> ();
</pre>
<p>restore the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> state to be as if the <a class="reference external" href="reference-Utility.html#hasher">hasher</a> has just been
default constructed.</p>
<a name="operator<<()"></a></div>
</div>
<div class="section" id="id36">
<h2>operator&lt;&lt;()</h2>
<p>Declared in &quot;<a class="reference external" href="../include/libtorrent/sha1_hash.hpp">libtorrent/sha1_hash.hpp</a>&quot;</p>
<pre class="literal-block">
std::ostream&amp; <strong>operator&lt;&lt;</strong> (std::ostream&amp; os, sha1_hash const&amp; peer);
</pre>
<p>print a sha1_hash object to an ostream as 40 hexadecimal digits</p>
<a name="operator>>()"></a></div>
<div class="section" id="id38">
<h2>operator&gt;&gt;()</h2>
<p>Declared in &quot;<a class="reference external" href="../include/libtorrent/sha1_hash.hpp">libtorrent/sha1_hash.hpp</a>&quot;</p>
<pre class="literal-block">
std::istream&amp; <strong>operator&gt;&gt;</strong> (std::istream&amp; is, sha1_hash&amp; peer);
</pre>
<p>read 40 hexadecimal digits from an istream into a sha1_hash</p>
</div>
</div>

    </div>
    </div>
    <div id="gradient"></div>
    <div id="footer">
    <table>
    <tr>
      <td><a href="index.html">home</a></td>
      <td><a href="https://blog.libtorrent.org">blog</a></td>
      <td><a href="utp.html">uTP</a></td>
    </tr>
    <tr>
      <td><a href="https://sourceforge.net/projects/libtorrent/files/libtorrent/">download</a></td>
      <td><a href="reference.html">documentation</a></td>
      <td><a href="dht_store.html">DHT put extension</a></td>
    </tr>
    <tr>
      <td><a href="https://sourceforge.net/projects/libtorrent/files/py-libtorrent/">python bindings</a></td>
      <td><a href="features.html">features</a></td>
      <td><a href="dht_sec.html">DHT security extension</a></td>
    </tr>
    <tr>
      <td><a href="https://sourceforge.net/p/libtorrent/mailman/libtorrent-discuss/">mailing list archive</a></td>
      <td><a href="contributing.html">contributing</a></td>
      <td><a href="streaming.html">streaming</a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/arvidn/libtorrent/issues">report a bug</a></td>
      <td><a href="building.html">building</a></td>
      <td><a href="bittorrent.pdf">bittorrent slides</a></td>
    </tr>
    </table>
    </div>
    <div id="filler"></div>

</div>
</body>
</html>
